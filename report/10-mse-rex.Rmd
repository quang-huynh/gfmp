\clearpage

```{r round2-function}
round2 <- function(x) sprintf("%.2f",round(x, 2))
```

# WEST COAST VANCOUVER ISLAND REX SOLE CASE STUDY {#app:mse-rex}

## BACKGROUND

Rex Sole (*Glyptocephalus zachirus*) occur from central Baja California to the western Bering Sea, and are generally distributed throughout coastal BC. They are sometimes referred to as "Witch Sole". Rex Sole are primarily caught in the groundfish bottom-trawl fishery in BC, which implemented 100% at-sea observer coverage and 100% dockside monitoring in 1996.

Rex Sole are caught in BC at depths between 20 m and greater than 1000 m, with most captured between 75 m and 450 m. Rex Sole as large as 58 cm and weighing up to 1.44 kg have been caught in BC waters. The oldest aged individual was a 34 cm female aged 15 years; however, there is very little available ageing data for this species, with the only data coming from the Hecate Strait Multispecies Assemblage Bottom Trawl survey in 1998. Otoliths have been collected on BC surveys from 2000--present although they have not been aged. Rex Sole have been aged up to 29 years (female) in the Gulf of Alaska [@abookire2006].

Rex Sole are commonly caught in the West Coast Vancouver Island (WCVI) synoptic groundfish bottom trawl survey (Figure \@ref(fig:rex-surv-set-plot)). While they are caught in the commercial mixed-species bottom trawl fishery (Figures \@ref(fig:rex-catch-plot) and \@ref(fig:rex-cpue-map)), there is no directed fishery or assigned quota for them.
They are commonly caught with Pacific Cod (*Gadus macrocephalus*), Dover Sole (*Microstomus pacificus*), English Sole (*Parophrys vetulus*) and Arrowtooth Flounder (*Atheresthes stomias*). Rex Sole have never been formally assessed in BC.
However, biomass of Rex Sole in Hecate Strait was estimated in 2012 using research survey data collected between 1984 and 2003 [@fargo2012].
The WCVI synoptic bottom trawl survey has shown a moderate decline in biomass density from ~2008 to 2012 and an increase from 2014 to 2018 (Figures \@ref(fig:rex-surv-set-plot) and \@ref(fig:rex-surv-index-plot)).
Standardized commercial trawl CPUE (catch per unit effort) increased in the late 1990s, showing a moderate decline from ~2004 to 2010, and a moderate increase until about 2016 (Figure \@ref(fig:rex-surv-index-plot)).
There are many samples of length, weight, otoliths, and maturity of Rex Sole from the WCVI synoptic survey, but no aged fish (Figure \@ref(fig:rex-samples)).
There are limited biological samples of any kind from the commercial fleet (Figure \@ref(fig:rex-samples)).

<!-- Commercial and research catch, effort, and biological data (lengths, weights, ages, maturity) are archived by the Groundfish Data Unit (Fisheries and Oceans Canada, Science Branch, Pacific Region) and housed in a number of relational databases.  Historical commercial catch and effort data from 1954--2006/2007 are housed in GFCatch, PacHarvTrawl, PacHarvHL, and PacHarvSable depending on the fishery and time period. Modern (2006/2007 to present) commercial catch data are housed in GFFOS, a groundfish-specific view of the Fishery Operations System (FOS) database (Fisheries and Oceans Canada, Fisheries and Aquaculture Management, Pacific Region). -->

<!-- In each commercial database there is an official catch table that provides the best available estimate of landed catch per location by applying the proportion of catch per set or area to trip-level landing data. Since 2015, the official catch tables from the various databases have been merged together into one master catch table in GFFOS (`GF_MERGED_CATCH`) to facilitate and standardize commercial data extraction. Catch proportions are calculated from the most spatially detailed information available on how much of each species was harvested per fishing tow/set or per area. In most cases this is the catch reported in observer logs or fisher logs. Older data contain records where set-level information was rolled up, for example, by area (see Rutherford (1999) for details on how catch was recorded in databases). These proportions are applied to the best available information on how much of each species was harvested on a trip. In most cases this will be the landed weight as recorded by the Dockside Monitoring Program. Earlier harvest data are recorded from sales slips or observer or fisher logs ([see @rutherford1999] for details on data sources). In 1996, mandatory 100% observer coverage was implemented for the commercial trawl fishery (and in 2006 for the hook and line sectors) improving the reliability of fishery data. -->

<!-- Research survey data and commercial biological data from the 1940s to present are housed in GFBio, the Groundfish Biological Samples database. In order to improve data on BC groundfish stocks, fishery-independent synoptic bottom trawl surveys were established in 2003 that are conducted in four areas: the west coast of Vancouver Island, Hecate Strait, Queen Charlotte Sound and the west coast of Haida Gwaii. The surveys alternately cover two areas each year. These survey and observer data are available to provide important time-series and biological data for stock assessment of a broad range of BC groundfish species. -->

In the US, Rex Sole are caught in the bottom trawl fishery and are considered to form three separate stocks: the Gulf of Alaska stock  [@mcgilliard2017], the Bering Sea/Aleutian Islands stock [@wilderbuer2015], and the West Coast stock from Washington to California [@cope2015].

We demonstrate the MP Framework here, through a case study of the Rex Sole stock in the WCVI groundfish management area (Area 3CD).
This detailed case study is illustrative and is not intended for catch advice at this time.
We frame our case study according to the steps outlined in Section \@ref(sec:approach).

```{r rex-survey-plotting-functions}
library(ggplot2)
library(dplyr)
library(here)
drex <- readRDS(here("generated-data", "rex-filter-data.rds"))
if (!file.exists(here("generated-data/rex-survey-sets.rds"))) {
  dsurv <- gfdata::get_survey_sets("rex sole", ssid = 4)
  saveRDS(dsurv, here("generated-data/rex-survey-sets.rds"))
} else {
  dsurv <- readRDS(here("generated-data/rex-survey-sets.rds"))
}
if (!file.exists(here("generated-data/rex-cpue-spatial.rds"))) {
  dcomm <- gfdata::get_cpue_spatial("rex sole")
  saveRDS(dcomm, here("generated-data/rex-cpue-spatial.rds"))
} else {
  dcomm <- readRDS(here("generated-data/rex-cpue-spatial.rds"))
}
# dsurv <- readRDS(here("../../gfs/report/data-cache/rex-sole.rds"))$survey_sets
# dcomm <- readRDS(here("../../gfs/report/data-cache/rex-sole.rds"))$cpue_spatial
drex$survey_sets <- dsurv
drex$cpue_spatial <- dcomm
plot_multiyear_survey_sets <- function(dat, survey_abbrev,
  density_column = "density_kgpm2",
  density_lab = expression(Density~(kg/km^2)), density_multiplier = 1e6) {
  dd <- gfplot::tidy_survey_sets(dat, survey_abbrev, years = seq(0, 1e6),
    density_column = density_column)
  coast <- gfplot:::load_coastline(range(dd$lon) + c(-1, 1),
    range(dd$lat) + c(-1, 1),
    utm_zone = 9
  )
  ggplot(filter(dd, present == 1), aes(X, Y,
    size = density*density_multiplier,
    fill = density*density_multiplier)) +
    scale_size_area(max_size = 8) +
    geom_point(data = filter(dd, present == 0), pch = 4,
      size = 1, col = "grey60", alpha = 0.5) +
    coord_equal(expand = FALSE, xlim = range(dd$X), ylim = range(dd$Y)) +
    geom_point(pch = 21, alpha = 0.5) +
    facet_wrap(~year) +
    geom_polygon(
      data = coast, aes_string(x = "X", y = "Y", group = "PID"),
      fill = "grey87", col = "grey70", lwd = 0.2, inherit.aes = FALSE) +
    scale_fill_viridis_c(trans = "sqrt") +
    labs(fill = density_lab,
      size = density_lab, x = "Easting",
      y = "Northing") +
    guides(
      size = guide_legend(order = 1),
      fill = guide_colourbar(order = 0)) +
    gfdlm::theme_pbs()
}
```

```{r rex-surv-set-plot, fig.cap="Individual survey tows for the West Coast Vancouver Island synoptic bottom trawl survey. Light gray crosses indicate survey sets that did not catch Rex Sole. The area and colour of the circles are proportional to the density of Rex Sole for that survey set. Eastings and Northings are for UTM zone 9.", fig.asp=1, fig.width = 9, out.width = "\\textwidth"}
plot_multiyear_survey_sets(dsurv, "SYN WCVI")
```

(ref:fig-rex-indexes)
West Coast Vancouver Island synoptic bottom trawl survey and standardized commercial bottom trawl CPUE for Rex Sole standardized according to the methods in @anderson2019synopsis. Each index is centred by its geometric mean for years 2004--2019 for visualization purposes. Dots represent mean estimates and line segments represent 95% confidence intervals. The index in the top panel is derived from the data shown in Figure \@ref(fig:rex-surv-set-plot) with confidence intervals generated via a stratified bootstrap procedure [for details, see, for example, @anderson2019synopsis].

```{r rex-surv-index-plot, fig.cap="(ref:fig-rex-indexes)", fig.width = 5, out.width = "4.3in", fig.asp=1.15}
# survey_cols <- c(RColorBrewer::brewer.pal(5L, "Set1"),
#       RColorBrewer::brewer.pal(8L, "Set1")[7:8],
#       "#303030", "#a8a8a8", "#a8a8a8", "#a8a8a8")
# survey_col_names <- c("SYN WCHG", "SYN HS", "SYN QCS", "SYN WCVI",
#     "HBLL OUT N", "HBLL OUT S", "IPHC FISS", "Commercial",
#     "HBLL INS N", "HBLL INS S", "MSA HS")
# survey_cols <- stats::setNames(survey_cols, survey_col_names)
# drex$survey_index %>%
#   gfplot::tidy_survey_index(survey = "SYN WCVI") %>%
#   gfplot::plot_survey_index(col = c("grey60", "grey20"), survey_cols = survey_cols) +
#   ylab("Survey relative biomass index")
rex_indexes <- readRDS(here("generated-data/rex-indexes.rds"))

d1 <- reshape2::melt(rex_indexes, id.vars = c("year"),
  measure.vars = c("syn_wcvi", "trawl_cpue"),
  variable.name = "index", value.name = "est") %>%
  mutate(index = as.character(index)) %>%
  mutate(index = ifelse(grepl("^syn", index), "SYN WCVI", "Trawl CPUE"))

d2 <- reshape2::melt(rex_indexes, id.vars = c("year"),
  measure.vars = c("syn_wcvi_sd", "trawl_sd"),
  variable.name = "index", value.name = ".sd") %>%
  mutate(index = as.character(index)) %>%
  mutate(index = ifelse(grepl("^syn", index), "SYN WCVI", "Trawl CPUE"))
d3 <- inner_join(d1, d2, by = c("year", "index"))

d3 <- group_by(d3, index) %>%
  mutate(est = est / exp(mean(log(est[year >= 2004]), na.rm = TRUE)))

ggplot(d3, aes(year, est)) +
  # geom_line(na.rm = TRUE) +
  facet_wrap(~index, ncol = 1) +
  geom_pointrange(aes(ymin = exp(log(est) - 2 * .sd), ymax = exp(log(est) + 2 * .sd)), na.rm = TRUE) + #, position = position_dodge(width = 0.3)
  theme_pbs() +
  ylab("Index (centred by its geometric mean)")+
  xlab("Year") +
 geom_linerange(aes(ymin = exp(log(est) - 2 * .sd), ymax = exp(log(est) + 2 * .sd)), na.rm = TRUE) +
  geom_point(pch = 21, size = 2, fill = "white", na.rm = TRUE)
```

```{r rex-catch-plot, fig.cap="Commercial catch for Rex Sole. Note that limited catch in the early 1990s is considered unreliable and is not shown. The shaded region prior to 1996 indicates the time period before the at-sea observer program was implemented for bottom and midwater trawl fleets.", fig.asp = 0.8, fig.width = 5, out.width = "4.5in"}
suppressWarnings({g <- drex$catch %>%
  gfplot::tidy_catch(areas = "3[CD]+") %>%
  gfplot::plot_catch(xlim = c(1954, 2019), unreliable = c(1996))})
g + labs(title = "")
```

```{r rex-cpue-map, fig.cap="Spatial commercial trawl CPUE for Rex Sole for tows that caught any Rex Sole from 2013--2019. Cells are 4 km wide and are only shown in cases where there are at least three unique vessels in a given cell to meet federal privacy requirements. CPUE is calculated as the weight of catch (landings plus discards) divided by hours fished for all positive tows from the groundfish trawl sector. Trawl data are shown from 2013 onwards after the trawl footprint was frozen.", fig.width = 7.75, out.width = "\\textwidth"}
drex$cpue_spatial %>%
  dplyr::filter(year >= 2013, year <= 2019) %>%
  dplyr::filter(major_stat_area_code %in% c("03", "04")) %>%
  gfplot::plot_cpue_spatial(xlim = c(500, 890), ylim = c(5353, 5700),
    percent_excluded_xy = c(0, 0), bin_width = 4)
```

```{r rex-samples, fig.cap="Specimen availability for Rex Sole. Shown are the number of available fish specimens that have had their length measured, have been weighed, had their maturity assessed, had their age assessed, and for which ageing structures are available for ageing. Blank panels indicate year-measurement combinations without any data. Shading of these cells reflects the relative number of specimens available with the actual number of specimens indicated in the cells to the nearest round number.", fig.asp = 0.6, fig.width = 7, out.width = "6in"}
# viridis::scale_fill_viridis(option = "D", end = 0.82, na.value = na_colour)}
g1 <- drex$survey_samples %>%
  gfplot::tidy_sample_avail(year_range = c(1996, 2019)) %>%
  gfplot::plot_sample_avail(title = "Biological specimens") +
  scale_fill_viridis_c(option = "C", na.value = "white", end = 0.82)

g2 <- drex$commercial_samples %>%
  gfplot::tidy_sample_avail(year_range = c(1996, 2019)) %>%
  gfplot::plot_sample_avail(title = "Commercial specimens") +
  scale_fill_viridis_c(option = "D", na.value = "white", end = 0.82)

cowplot::plot_grid(g1, g2, nrow = 2)
```

(ref:fig-rex-syn1)
First Rex Sole page from @anderson2019synopsis. (Temporary placeholder until we properly plot out just the relevant data.)

```{r rex-syn1, fig.cap="(ref:fig-rex-syn1)", out.width="6in"}
# knitr::include_graphics(here("images/rex-sole-1.png"))
```

(ref:fig-rex-syn2)
Second Rex Sole page from @anderson2019synopsis. (Temporary placeholder until we properly plot out just the relevant data.)

```{r rex-syn2, fig.cap="(ref:fig-rex-syn2)", out.width="6in"}
# knitr::include_graphics(here("images/rex-sole-2.png"))
```

\clearpage

## STEP 1: DEFINE THE DECISION CONTEXT {#sec:results-rex1}

The decision to be made is which MP to use to determine catch limits for the period until the next available catch advice. The time-frame for making the decision would be stated in the Request for Science Advice. In applications of the MP Framework, additional aspects of the decision context would be established through a technical committee. See Section \@ref(sec:approach1).

## STEP 2: SELECTION OF OBJECTIVES AND PERFORMANCE METRICS  {#sec:results-rex2}

We defined the objectives for Rex Sole based on the provisional objectives presented in Section \@ref(sec:approach2). These objectives are guided by the Precautionary Approach Framework, elements of which are incorporated into the Fish Stocks provisions of the *Fisheries Act*.

1. Maintain stock status above the LRP in the long term with high probability.
2. Maintain stock status above the USR in the long term with moderately high probability.
3. Maintain a fishing exploitation rate below the rate at maximum sustainable yield with some probability.
4. Given the above conservation objectives are achieved, maximize short- and long-term fisheries catch.
5. Given the above conservation objectives are achieved, minimize variability in fisheries catch from year to year.

Our estimated length-at-50% maturity (25.8 cm), coupled with our estimated growth parameters, imply an age-at-50% maturity of approximately 4--5 years.
Since 1.5 to 2 generations would be less than 50 years, we chose to base our long-term performance metrics on a 50-year projection.

The performance metrics measuring the objectives were:

1. LT LRP: Probability *B* > 0.4 *B*~MSY~ (years 35--50).
2. LT USR: Probability *B* > 0.8 *B*~MSY~ (years 35--50).
3. FMSY: P(*F* < *F*~MSY~) (years 1--50).
4. STC: Probability catch > reference catch (years 1--10).
5. LTC: Probability catch > reference catch (years 35--50).
6. AADC: Probability AADC (average absolute interannual difference in catch) < historical AADC (years 1--50).

Reference catch was defined as the average catch from the last five years.
We measured the performance metrics as probabilities integrated over years and replicates simultaneously.

## STEP 3: SELECTION OF UNCERTAINTIES AND SPECIFICATION OF OPERATING MODELS {#sec:results-rex3}

We considered the major axes of uncertainty for Rex Sole to be:

1. The magnitude of the commercial catch prior to 1996 (influencing initial depletion in 1996)
2. The importance of the commercial CPUE index
3. The value of the steepness parameter (*h*) of the stock-recruit relationship
4. The value of natural mortality (*M*)
5. The age selectivity pattern of the commercial fleet and survey gear

We divided OM scenarios into a reference set and a robustness set (Section \@ref(sec:best3)). We defined six OM reference-set scenarios that differed from each other in these respects and two OM robustness-set scenarios (Table \@ref(tab:rex-scen)), with parameter values provided in Appendix \@ref(app:desc-om-rex). We describe each of the OM scenarios below.

```{r rex-scen, results='asis'}
sc <- readRDS(here("generated-data/rex-scenarios.rds"))
sc <- sc %>%
  select(-order) %>%
  mutate(scenario_human = gsub("inc\\.", "increasing", scenario_human)) %>%
  mutate(scenario_human = gsub("\\\n", " ", scenario_human)) %>% 
  mutate(scenario_human = gsub("Ceq.", "C^eq^", scenario_human))
sc %>% select(-scenario) %>%
  csasdown::csas_table(caption = "Rex Sole OM scenarios. \"C^eq^\" refers to \"catch equilibrium\" in 1995 and is used to parameterize the level of biomass depletion at the beginning of the recorded catch history. Unless otherwise specified, \"C^eq^\" was set at 200% in all scenarios.",
    col_names = c("OM scenario name", "Set type")) %>%
  kableExtra::kable_styling(latex_options = c("hold_position"))
```

### Reference set {#sec:results-reference-set}

#### Magnitude of pre-1996 commercial catch and importance of commercial CPUE

Prior to 1996, reported catches for WCVI Rex Sole were much lower than post-1995 and there were no reported discards.
We have removed these catches from Figure \@ref(fig:rex-catch-plot) because these data are considered unreliable due to a lack of reporting requirements and at-sea observer coverage prior to 1996.
Assumptions about pre-1996 catch levels affect the SRA model's estimates of the depletion level in 1996 (Appendix \@ref(app:sra)).
The SRA model parameter $C^{\textrm{eq}}$, describes the equilibrium catch in weight prior to the first year of the model (1996 for Rex Sole), which is used to estimate equilibrium fishing mortality $F^{\textrm{eq}}$ prior to the first year of the model, which in turn is used to calculate total mortality $Z^{\textrm{eq}}$ needed to calculate recruits and numbers in the first year of the model (Equation \@ref(eq:sra-om-ceqpred)).
We note that the use of $F^{\textrm{eq}}$ and $C^{\textrm{eq}}$ make the assumption that the population biomass and fishery were in equilibrium prior to 1996.
While this is likely an unrealistic assumption, it is a convenient means of initializing a population model in the presence of fishing.
For this reason, we treated the value of $C^{\textrm{eq}}$ as a major axis of uncertainty.

We attempted to fit $C^{\textrm{eq}}$ values ranging from 0 to 2.5 times the 1996 catch, which imply that equilibrium catch in 1995 was 0% to 250% of the 1996 catch, respectively.
The SRA model estimated implausibly high values of fishing mortality ($F_{a,y} > 3$) for values of $C^{\textrm{eq}} < 200\%$ of 1996 catch, suggesting that there may have been considerable unrecorded, possibly discarded, catch prior to 1996, also implying that the stock was unlikely to have been close to $B_0$ in 1995.
Therefore, our reference set includes only two levels of $C^{\textrm{eq}}$ that we thought rendered plausible OM conditioning.
We include an additional OM scenario with the 1995 stock closer to $B_0$ in the robustness set (Section \@ref(sec:results-robustness-set)).

We believe the assumption of unrecorded catch prior to 1996 is consistent with the data and knowledge of the multispecies groundfish fishery for three reasons.
First, the standardized commercial CPUE index shows an increasing trend from 1996 to 2003 before the SYN WCVI survey began (Figure \@ref(fig:rex-surv-index-plot)).
Given that Rex Sole were not a targeted species, it seems unlikely that the fishery began catching Rex Sole coincident with the introduction of 100% at-sea observer coverage and dockside monitoring.
Increasing CPUE is also consistent with (but not necessarily indicative of) a stock rebuilding from a depleted state.
While there are many caveats associated with commercial CPUE time series, two factors suggest this trend is plausible: (a) commercial CPUE has somewhat mirrored the broad patterns seen in the SYN WCVI survey index since the survey began (Figure \@ref(fig:rex-surv-index-plot)); and (b) Rex Sole have not been a targeted species by the commercial trawl fleet.
The absence of targeting removes some of the reasons why CPUE trends may not reflect abundance trends.
Second, the SYN WCVI survey has approximately doubled its relative index value for Rex Sole since the early 2000s, which would be consistent with the stock starting in a somewhat depleted state in 1996.
Third, other species that are commonly caught with Rex Sole in catch records since 1996 were reported to have been caught in substantial quantities before 1996 [@anderson2019synopsis].
It therefore seems reasonable to assume that there was considerable unrecorded catch prior to 1996.

We considered three OM reference-set scenarios and one OM robustness-set scenario that varied in the assumed value of $C^{\textrm{eq}}$ (Table \@ref(tab:rex-scen)).
For the reference set:

* The OM scenario "C^eq^ 200%" assumes that equilibrium catch prior to 1996 was twice that in 1996.

* The OM scenario "C^eq^ 250%" assumes that equilibrium catch prior to 1996 was 2.5 times that in 1996.

* The OM scenario "No CPUE C^eq^ 250%" excludes the commercial CPUE index from the SRA model (Figure \@ref(fig:rex-surv-index-plot)). When the commercial CPUE data were excluded, values of $C^{\textrm{eq}} < 2.5$ rendered implausible SRA model fits ($F_{a,y} > 3$) without other changes to the model such as shifting length selectivity.

For all other OM scenarios $C^{\textrm{eq}}$ was set at 200%.
We did explore some OM scenarios with $C^{\textrm{eq}} > 250\%$ (not shown).
These OM scenarios did not provide greater contrast in terms of the ranking of MPs and we chose to cap $C^{\textrm{eq}}$ at 250% in this case study.

#### Steepness of the stock-recruit relationship (*h*)

We considered one alternative OM scenario that differed in terms of the value of *h* (Table \@ref(tab:rex-scen)).
Unless otherwise stated, all other OM scenarios drew from a baseline beta distribution $h \sim \textrm{beta}(13.4, 2.4)$, which results in a mean and standard deviation of 0.85 and 0.09 (see Section \@ref(app:desc-stock-h-rex)).

* The OM scenario "Higher steepness" uses the value $h = 0.95$.

#### Natural mortality (*M*)

We considered one alternative OM scenario that differed in terms of the value of *M* (Table \@ref(tab:rex-scen)).
Unless otherwise stated, all other OM scenarios drew from a baseline uniform distribution *M* = 0.17--0.25 *y*^-1^, which starts at the value of 0.17 *y*^-1^ used for the Gulf of Alaska stock assessment of Rex Sole (@mcgilliard2017, see Section \@ref(app:desc-stock-m-rex)) and explores a slightly higher range since *M* is likely to be somewhat greater at a lower latitude.

* The OM scenario "Higher M" considers that *M* could be latitude-dependent and may be substantially higher for stocks in warmer BC waters (*M* = 0.3 *y*^-1^).

#### Selectivity

We considered one alternative OM scenario that differed in terms of the length- and age-selectivity of the commercial fleet and the WCVI synoptic survey (Table \@ref(tab:rex-scen)).
Unless otherwise stated, all other OM scenarios drew from a length selectivity curve that approximately matched the maturity ogive ($L^5 = 22$, $L^\textrm{FS} = 32$).

* The OM scenario "Lower selectivity" considers that the selectivity curve could be shifted to the left resulting in both the survey and the commercial fleet capturing younger fish ($L^5 = 17$, $L^\textrm{FS} = 28$).

We considered the above six OM scenarios to represent the most plausible uncertainty OM scenarios for Rex Sole and grouped them into the "reference set" of OMs (see Section \@ref(sec:best3)).

### Robustness set {#sec:results-robustness-set}

To illustrate application of the framework in the presence of additional sources of structural uncertainty, we included two OM robustness scenarios (Table \@ref(tab:rex-scen)):

* The "No CPUE C^eq^ 50%" OM scenario assumes that catch at equilibrium in year 1995 was 50% of the catch in 1996 ($C^{\textrm{eq}} = 0.5$). In other words, this OM scenario assumes that the stock started in a much less depleted state than the other OM scenarios. In order to fit the SRA model with plausible $F_{a,y}$ values, we also had to omit the commercial CPUE and use the selectivity curve described in the "Lower selectivity" OM scenario.

* The "M increasing" OM scenario assumes that *M* was fixed at 0.2 *y*^-1^ in the historical period and increases monotonically from 0.2 to 0.4 *y*^-1^ over the projection period. This could represent increasing natural mortality due to a process such as climate change or shifts in predator abundance. We include this OM scenario simply to illustrate including a time-varying parameter in the OM projection period that reflects an underlying environmental process, and to assess robustness of MPs to such a scenario.

Results from the Robustness Set will be presented separately in Section \@ref(sec:results-rex6) and will be used to show whether performance of MPs is significantly affected by these other sources of uncertainty.

<!-- Maturity
Abookire 2006 - GOA ML50 females = 352 mm, ML100 = 420 mm) significantly larger size than in Oregon
MA50 = 5.1 years, all mature at age 9 except for two still immature at 9 and 10 years (n=557)
Hosie and Horton 1977 - Oregon female ML50 24 cm, ML100 = 30 cm
MA50 = 5 years, MA100 = 9 years (212 females, 45 unsexed age 1 fish)

Mortality
natural mortality used in GOA assessment 0.17-->

We include a detailed explanation of the initial OM specification in Appendix \@ref(app:desc-om-rex).

### OM conditioning {#sec:results-om-conditioning}

After specifying most of the OM parameters (Appendix \@ref(app:desc-om-rex)), we conditioned the OMs using the SRA model (with 250 replicates) described in Appendix \@ref(app:sra).
We conditioned the models using: (1) commercial catch data from 1996--2019; (2) the synoptic WCVI (SYN WCVI) trawl relative biomass index (a depth-stratified random survey); and (3) commercial bottom trawl CPUE.
We down-weighted the commercial CPUE index by inflating the standard errors 1.5 times since we have greater confidence in the SYN WCVI data reflecting underlying biomass trends.
We specified a range of $C^{\textrm{eq}}$ values as described above to reflect uncertainty in initial stock depletion.

The SRA was able to fit to the WCVI synoptic trawl survey relative biomass index and commercial bottom trawl CPUE reasonably well for all OM scenarios (Figure \@ref(fig:rex-survey-fits)).
The SYN WCVI survey was better fit than the commercial CPUE, likely due to the smaller standard errors (Figure \@ref(fig:rex-survey-fits)).
The SRA models fit the catch data almost perfectly by design, via setting the standard deviations of the observation error to a value of 0.01 (Equation \@ref(eq:sra-om-like-catch)).

(ref:fig-rex-survey-fits)
SRA model fits to the SYN WCVI and commercial bottom trawl CPUE relative biomass indices.
Panels from top to bottom represent OM scenarios.
Thin lines represent individual SRA model fits across stochastic draws from the various OM parameters.
Dots represent index mean and line segments represent 2 times the standard errors as entered into the SRA models.
In the case of the commercial CPUE, these standard errors have been inflated 1.5 times from the fitted standard errors to down-weight the commercial CPUE index relative to the survey index.

```{r rex-survey-fits, fig.cap="(ref:fig-rex-survey-fits)", out.width="0.65\\textwidth"}
knitr::include_graphics(here("report/figure/rex-index-fits.png"))
```

We used the SRA to populate the following parameters in the conditioned OMs:

- $B_{t_c}/B_0$ (or "D"; depletion in the last historical year)
- $R_0$ (unfished recruitment)
- $\theta_\textrm{AC}$ (or "AC"; first-order autocorrelation of recruitment deviations)
- $F_{a,y}$ (fishing mortality at age by year)
- $\varepsilon_{\textrm{R},y}$ for years $t_1$ to $t_c$ (historical recruitment deviations)

The OM reference and robustness scenarios rendered a range of estimated parameter values (Figures \@ref(fig:rex-sra-conditioned-parameters), \@ref(fig:rex-F-om), \@ref(fig:rex-recdev-om)).
In fitting the SRA across replicate draws from the initial OMs, we discarded any models that did not converge (with convergence defined as a positive-definite covariance matrix) or had $F_{a,y} > 3$.
The majority of replicates were retained (Table \@ref(tab:rex-sra-fraction)).
However, by discarding  replicates from non-converged models, the input parameters carried through to the conditioned OMs varied slightly (Figure \@ref(fig:rex-sra-conditioned-parameters2)).
The discarded parameter values represent implausible parameter combinations according to the SRA model.
The implied spawning stock biomass depletion trajectories during the historical period from the eight OMs were similar with the exception of the "No CPUE C^eq^ 50%" OM scenario (Figure \@ref(fig:rex-depletion-om)).

```{r rex-sra-fraction, results='asis'}
rex_converged <- readRDS(here("generated-data/rex-converged.rds"))
rex_converged %>%
  mutate(fraction_converged = sprintf("%.2f",round(nsim / 650, 2))) %>%
  mutate(scenario = gsub("\\n", " ", scenario)) %>% 
  mutate(scenario = gsub("Ceq.", "C^eq^", scenario))%>%
  select(-nsim) %>%
  csasdown::csas_table(col_names = c("OM Scenario", "Fraction retained"),
    caption = "Fraction of replicates retained after conditioning with the SRA model.")
```

(ref:fig-rex-sra-conditioned-parameters) Histograms of parameters estimated by the SRA. Fishing mortality at age, the historical depletion trajectory, and historical recruitment deviations are also derived from the SRA model. Historical depletion trajectories are shown in Figure \@ref(fig:rex-depletion-om), apical fishing mortality by year are shown in Figure \@ref(fig:rex-F-om), and historical recruitment deviations are shown in Figure \@ref(fig:rex-recdev-om).
D refers to depletion. AC refers to $\theta_\textrm{AC}$.

```{r rex-sra-conditioned-parameters, out.width="0.85\\textwidth", fig.cap="(ref:fig-rex-sra-conditioned-parameters)"}
knitr::include_graphics(here("report/figure/rex-sra-estimated.png"))
```

(ref:fig-rex-sra-conditioned-parameters2)
Frequency polygons for parameters input to the SRA. Parameters were sampled stochastically as input into the SRA (see Appendix \@ref(app:desc-om-rex) for ranges). Any samples associated with non-converged SRA models were discarded. Since most SRA models converged, these distributions are similar across OM scenarios unless they were specified differently in the OM. The large spikes represent fixed parameter values in the OM. sigma_R refers to $\sigma_R$.

```{r rex-sra-conditioned-parameters2, out.width="\\textwidth", fig.asp=0.85, fig.width=7, fig.cap="(ref:fig-rex-sra-conditioned-parameters2)"}
knitr::include_graphics(here("report/figure/rex-sra-filtered.png"))
```

\clearpage

(ref:fig-rex-depletion-om)
Spawning stock biomass ($B$) depletion trajectories for reference and robustness set OMs.
Depletion is represented as a fraction of $B_0$ (spawning stock biomass at unfished equilibrium).
Note that the "M increasing" OM scenario only represents M increasing in the future projections---not the historical time period illustrated here---and uses a fixed value of M in the historical period.
Lines represent medians, and dark and light-grey shading represent 50% and 95% quantiles across replicates.

```{r rex-depletion-om, fig.cap="(ref:fig-rex-depletion-om)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-compare-SRA-depletion-panel.png"))
```

(ref:fig-rex-F-om)
Apical fishing mortality ($F_y$) trajectories for reference and robustness set OMs.
Apical fishing mortality is the maximum $F_{a,f}$ experienced by fish of any age in a given year.
Lines represent medians, and dark and light grey shading represent 50% and 95% quantiles across replicates.

```{r rex-F-om, fig.cap="(ref:fig-rex-F-om)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-compare-F-panel.png"))
```

(ref:fig-rex-recdev-om)
Historical recruitment deviations estimated by the SRA model (in log space).
Lines represent 100 random samples from the replicates.

```{r rex-recdev-om, fig.cap="(ref:fig-rex-recdev-om)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-compare-recdev-panel.png"))
```

\clearpage

## STEP 4: IDENTIFICATION OF CANDIDATE MANAGEMENT PROCEDURES  {#sec:results-rex4}

We started with the full set of provisional candidate MPs described in Appendix \@ref(app:MPs) (Table \@ref(tab:rex-mps)).
Early explorations with the SP models  suggested little effect of the three alternative harvest control rules (HCRs) described in Section \@ref(sec:mp-sp) (presumably because the projected biomass spent little time on the HCR "ramp").
There was also very little difference in performance between the Fox and Schaefer production models.
Therefore, for the SP models we focused mostly on tuning the prior on $r$, the intrinsic population growth rate.
We evaluated three priors on $r$: $\textrm{Normal}(0.4, 0.1)$, $\textrm{Normal}(0.5, 0.1)$, and $\textrm{Normal}(0.6, 0.1)$.
With the Schaefer surplus production function, these correspond to $F_\textrm{MSY} = 0.2$, $F_\textrm{MSY} = 0.25$, and $F_\textrm{MSY} = 0.3$, which approximately match the values of *M* explored in the OMs.
We included the provisional "meta" HCR rules described in Appendix \@ref(app:MPs) Section \@ref(sec:mp-sp) and given that the stock does not have an existing TAC, we set the initial TAC for the purpose of the "meta" rules to the average catch from the last five years of the historical period.
In applications of the framework, additional tuning of SP models and index-based MPs could be explored if needed.

```{r rex-mps, results='asis'}
mp <- readr::read_csv(here("analysis", "rex", "mp.txt"), comment = "#")
mp_list <- split(mp, mp$type)
csasdown::csas_table(mp, caption = "Candidate MPs. The '`.`' in front of some MPs denotes versions of the MPs that only observe the survey index every second year to mimic our biennial WCVI synoptic survey. .SP6040_0.4 refers to an SP model with a prior on $r$ of 0.4, etc.", col_names = c("Management procedure", "MP type"))
```

## STEP 5: SIMULATION OF THE APPLICATION OF THE MANAGEMENT PROCEDURES  {#sec:results-rex5}

```{r}
pm_df_list <- readRDS(here("generated-data/rex-pm-all.rds"))
pm_all <- bind_rows(pm_df_list, .id = "scenario")
pm_avg <- group_by(pm_all, MP) %>%
  summarise_if(is.numeric, mean, na.rm = TRUE)
pm_min <- group_by(pm_all, MP) %>%
  summarise_if(is.numeric, min, na.rm = TRUE)
reference_mp <- c("FMSYref75", "NFref", "FMSYref")


satisficed_criteria <- c("LT LRP" = 0.9, "STC" = 0.8)
# plot_tigure(pm_avg, satisficed = satisficed_criteria)
# plot_tigure(pm_min, satisficed = satisficed_criteria)

mp_sat <- dplyr::filter(pm_min, `LT LRP` > satisficed_criteria[1], `STC` > satisficed_criteria[2]) %>%
  pull(MP)
mp_sat <- mp_sat[!mp_sat %in% reference_mp]
mp_sat_b4_cut <- mp_sat

mp_sat <- mp_sat[!mp_sat %in% c(".SP4010_0.6", ".SP6040_0.6_fox", ".SP6040_0.6")]
mp_sat <- mp_sat[!mp_sat %in% c("CC_hist20")] # similar to "CC1.2"
mp_sat <- mp_sat[!mp_sat %in% reference_mp]

pm_avg_sat <- pm_avg %>% filter(MP %in% mp_sat)
pm_min_sat <- pm_min %>% filter(MP %in% mp_sat)
rversion <- gsub(" \\([0-9-]+\\)", "", devtools::session_info()$platform$version)
```

We ran the closed-loop simulations across 250 stochastic replicates using DLMtool version 5.4.2, `r rversion`, and the simulation random seed set to `1`, with the OMs and MPs described above.
We assessed convergence of the closed-loop simulation by plotting the cumulative performance metrics as replicates were added (Figure \@ref(fig:rex-converge)).
We deemed 250 replicates sufficient since the rank order of MPs was consistent for this number of replicates (Figure \@ref(fig:rex-converge)).

To determine which MPs would be carried forward as satisficed MPs [@miller2010], we began by assessing average and minimum performance across all candidate MPs for the reference set of OMs (Figures \@ref(fig:rex-tigure-avg) and \@ref(fig:rex-tigure-min)).
To obtain a manageable number of MPs for further consideration, we set satisficing thresholds of `r names(satisficed_criteria)[1]` $>$ `r satisficed_criteria[[1]]` (9 times out of 10) and `r names(satisficed_criteria)[2]` $>$ `r satisficed_criteria[[2]]` (4 times out of 5).
We could apply these criteria to either the average (Figures \@ref(fig:rex-tigure-avg)) or minimum performance (Figures \@ref(fig:rex-tigure-min)) and such a decision is likely best made by a technical working group or decision-makers coupled with stakeholders in an applied setting.
In this case study, it made little difference whether we chose the average or minimum performance metrics to apply the satisficing criteria.
For the purposes of this case study, we chose to apply the satisficing criteria to the minimum performance metrics.
This implies that the satisficed MPs pass these criteria even in the worst-case OM reference-set scenario.
Applying these criteria resulted in `r number_to_word(length(mp_sat_b4_cut))` remaining MPs (`r gfutilities::commify(sort(mp_sat_b4_cut))`).

We additionally decided to omit four MPs from further consideration.
First, we chose to retain only one satisficed SP model MP (.SP8040_0.6) since the SP model MPs that differed only in production-function shape (.SP6040_0.6_fox) or HCR (.SP6040_0.6 and .SP4010_0.6) had near identical performance (Figure \@ref(fig:rex-tigure-min)).
Second, we removed CC_hist20 since it was outperformed by the other constant catch MPs---LT LRP and STC were both exceeded by all other constant-catch MPs (Figure \@ref(fig:rex-tigure-min)).
This left `r number_to_word(length(mp_sat))` MPs (`r gfutilities::commify(sort(mp_sat))`).

(ref:fig-rex-converge)
Assessing convergence of the Rex Sole closed-loop simulations on consistent rank order of MPs within performance metrics.
Colours represent individual satisficed and reference MPs.
Lines that do not cross by the final replicates indicate that rank order among replicates had converged.
Although not shown, we also checked that the satisficing rules had converged (i.e., the selection of satisficed MPs did not change with additional replicates).
Note that in the "M increasing" OM scenario the LTC and AADC metrics do not appear because they are below the lower y-axis limit (or perfectly at 1 in the case of AADC and NFref).

```{r rex-converge, fig.cap="(ref:fig-rex-converge)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-convergence.png"))
```

(ref:fig-rex-tigure-avg) Average performance of all candidate MPs across the reference set of OMs.
MPs are ordered by decreasing performance metric values from top to bottom starting with the left-most performance metric (LT LRP) and using columns from left to right to break any ties.
The colour shading reflects the probabilities.
Outlined cells represent MPs that met a particular performance metric's satisficing criteria.
Using this set of criteria, MPs would be "satisficed" if cells in *both* "LT LRP" and "STC" were outlined.
Light grey MPs indicate reference MPs.

```{r rex-tigure-avg, fig.cap="(ref:fig-rex-tigure-avg)", out.width="3.5in"}
knitr::include_graphics(here("report/figure/rex-tigure-refset-avg.png"))
```

(ref:fig-rex-tigure-min) Minimum performance of all candidate MPs across the reference set of OMs.
This figure is the same as Figure \@ref(fig:rex-tigure-avg) but shows the **minimum** performance metric across the OMs in the reference set for the purposes of applying satisficing rules.
In other words, this figure illustrates the worst performance of each MP across the reference set of OMs.

```{r rex-tigure-min, fig.cap="(ref:fig-rex-tigure-min)", out.width="3.5in"}
knitr::include_graphics(here("report/figure/rex-tigure-refset-min.png"))
```

\clearpage

## STEP 6: PRESENTATION OF RESULTS AND SELECTION OF MANAGEMENT PROCEDURE  {#sec:results-rex6}

### Reference set results

Performance within the reference set of OMs varied across MPs and performance metrics (Figures \@ref(fig:rex-tigure-avg), \@ref(fig:rex-tigure-min), \@ref(fig:rex-tigure-panel), and \@ref(fig:rex-dot-lines)).
There was variability in performance among the individual OM reference-set scenarios with the most variability in both the long-term and entire projection period performance metrics: LT USR, FMSY, LTC, and AADC (Figure \@ref(fig:rex-tigure-panel)).
Between the two performance metrics used in the initial satisficing step, *average* LT LRP varied between `r round2(min(pm_avg_sat$"LT LRP"))` and `r round2(max(pm_avg_sat$"LT LRP"))`, and STC varied between `r round2(min(pm_avg_sat$STC))` and `r round2(max(pm_avg_sat$STC))` across MPs within the reference set (Figure \@ref(fig:rex-tigure-avg) and \@ref(fig:rex-tigure-panel)).
*Minimum* LT LRP varied between `r round2(min(pm_min_sat$"LT LRP"))` and `r round2(max(pm_min_sat$"LT LRP"))`, and STC varied between `r round2(min(pm_min_sat$STC))` and `r round2(max(pm_min_sat$STC))` across MPs within the reference set (Figure \@ref(fig:rex-tigure-min) and \@ref(fig:rex-tigure-panel)).

A dot-and-line plot of the performance metrics aggregated across OM scenarios helps compare performance across satisficed MPs (Figure \@ref(fig:rex-dot-lines)).
Long-term catch (LTC) was roughly comparable between a fishing strategy of fishing at *F*/*F*~MSY~ and the satisficed Itarget or .SP8040_0.6 MPs (Figure \@ref(fig:rex-dot-lines)).
Short-term catch (STC) of all satisficed MPs exceeded these reference MPs (Figure \@ref(fig:rex-dot-lines)).
Fixed-catch MPs of 1.1- or 1.2-times average catch from the last five years rendered similar performance to other satisficed MPs across most performance metrics within the OM reference-set scenarios, with somewhat higher LTC and AADC metrics (Figure \@ref(fig:rex-dot-lines)).
These fixed-catch MPs do not incorporate feedback between the management and biological systems.

Trade-offs among performance metrics for most of the satisficed MPs were relatively minor within the OM reference-set scenarios (Figures \@ref(fig:rex-tradeoff-reference) and \@ref(fig:rex-spider-satisficed-mps-avg)).
Within the "C^eq^ 200%" OM scenario, there was a slight trade-off between STC and LT LRP (Figure \@ref(fig:rex-tradeoff-reference)).
The time series trajectories of the projected survey index (Figure \@ref(fig:rex-proj-index)), *B*/*B*~MSY~, *F*/*F*~MSY~, and catch (Figures \@ref(fig:rex-proj-ceq200)--\@ref(fig:rex-proj-no-cpue)) further demonstrate performance across the various MPs and reference-set OMs.
Kobe plots demonstrate either the final *B*/*B*~MSY~ vs. *F*/*F*~MSY~ status among replicates (Figure \@ref(fig:rex-kobe)) or the trajectory of these stock status values through time (Figure \@ref(fig:rex-worm)).

(ref:fig-rex-tigure-panel) Performance of satisficed MPs for the reference-set OMs.
MPs are ordered by decreasing performance metric values from the averaged reference set (Figure \@ref(fig:rex-tigure-avg)).
These are the same data underlying Figure \@ref(fig:rex-tigure-avg) and Figure \@ref(fig:rex-tigure-min) but shown for individual OM reference-set scenarios and only for satisficed MPs.

```{r rex-tigure-panel, fig.cap="(ref:fig-rex-tigure-panel)", out.width="0.8\\textwidth"}
knitr::include_graphics(here("report/figure/rex-tigure-refset.png"))
```

\clearpage

(ref:fig-rex-dot-lines)
Dot-and-line plot of performance metrics averaged across OM scenarios.
Dots represent average performance metric values and thin lines represent the range of values across OM scenarios.
Thick lines represent the range of values across OM scenarios after dropping the high and low values.
Reference MPs are indicated by open circles (True).
Non-reference MPs are indicated by closed circles (False).

```{r rex-dot-lines, fig.cap="(ref:fig-rex-dot-lines)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-dot-refset-avg.png"))
```

\clearpage

```{r rex-tradeoff-reference, fig.cap="Trade-off between LT LRP and STC average performance metrics across the OM reference-set scenarios. Reference MPs are indicated by open circles (True). Non-reference MPs are indicated by closed circles (False).", out.width="5in"}
knitr::include_graphics(here("report/figure/rex-tradeoff-refset-avg.png"))
```

\clearpage

```{r rex-spider-satisficed-mps-avg, fig.cap="Radar-plot representation of average performance metric trade-offs for the OM reference-set scenarios. The outside of the hexagon represents a performance metric probability of 1.0; in the middle represents a value of 0. Dashed lines represent reference MPs.", out.width="5in"}
knitr::include_graphics(here("report/figure/rex-radar-refset-avg.png"))
```

\clearpage

```{r rex-proj-index, fig.cap="Historical and projected SYN WCVI relative biomass index values. Vertical dashed line represents 2019. The shaded region represents the 95\\% quantile and individual lines represent four sample replicates.", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-projections-index.png"))
```

\clearpage

(ref:fig-rex-proj-ceq200) B/B~MSY~, F/F~MSY~, and catch from the historical and projected time periods for the "C^eq^ 200%" OM.
Dark line indicates the median value and the darker and lighter shaded ribbons indicate the 50% and 90% quantiles.
Thin gray lines represent illustrative simulation replicates.
The vertical dashed line indicates the last year of the historical period.
The horizontal dashed lines indicate B/B~MSY~ = 0.8 and 0.4 and F/F~MSY~ = 1.

```{r rex-proj-ceq200, fig.cap="(ref:fig-rex-proj-ceq200)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-ceq200.png"))
```

(ref:fig-rex-proj-ceq250-cpue) Same as Figure \@ref(fig:rex-proj-ceq200) but for the OM "C^eq^ 250%".

```{r rex-proj-ceq250-cpue, fig.cap="(ref:fig-rex-proj-ceq250-cpue)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-ceq250.png"))
```

(ref:fig-rex-proj-high-m) Same as Figure \@ref(fig:rex-proj-ceq200) but for the OM "Higher M".

```{r rex-proj-high-m, fig.cap="(ref:fig-rex-proj-high-m)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-high-m.png"))
```

(ref:fig-rex-proj-high-h) Same as Figure \@ref(fig:rex-proj-ceq200) but for the OM "Higher steepness".

```{r rex-proj-high-h, fig.cap="(ref:fig-rex-proj-high-h)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-high-h.png"))
```

(ref:fig-rex-proj-low-sel) Same as Figure \@ref(fig:rex-proj-ceq200) but for the OM "Lower selectivity".

```{r rex-proj-low-sel, fig.cap="(ref:fig-rex-proj-low-sel)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-sel1.png"))
```

(ref:fig-rex-proj-no-cpue) Same as Figure \@ref(fig:rex-proj-ceq200) but for the OM "No CPUE C^eq^ 250%".

```{r rex-proj-no-cpue, fig.cap="(ref:fig-rex-proj-no-cpue)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-no-cpue.png"))
```

\clearpage

(ref:fig-rex-kobe) B/B~MSY~ and F/F~MSY~ values from the final year of the projections across all replicates.
Dots represent individual replicates.
Vertical dashed lines show B/B~MSY~ = 0.4 (left) and 0.8 (right).
Horizontal dashed line shows F/F~MSY~ = 1.
Contour lines indicate two-dimensional kernel-density-smoothed quantiles at 0.25, 0.50, and 0.75 levels, calculated in log space.

```{r rex-kobe, fig.cap="(ref:fig-rex-kobe)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-kobe.png"))
```

\clearpage

(ref:fig-rex-worm) Trajectory of B/B~MSY~ and F/F~MSY~ values summarized across replicates.
The solid line corresponds to the median value.
Vertical dashed lines show B/B~MSY~ = 0.4 (left) and 0.8 (right).
Horizontal dashed line shows F/F~MSY~ = 1.
Each diamond represents the 50% quantile of B/B~MSY~ (horizontal) and F/F~MSY~ (vertical).

```{r rex-worm, fig.cap="(ref:fig-rex-worm)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-worms-proj.png"))
```

\clearpage

### Robustness set results

<!--
Figure \@ref(fig:rex-tigure-panel-rob)
Figure \@ref(fig:rex-dots-satisficed-mps-robust)
Figure \@ref(fig:rex-tradeoff-robust)
Figure \@ref(fig:rex-spider-satisficed-mps-robust)

Figure \@ref(fig:rex-proj-no-cpue-light) and Figure \@ref(fig:rex-proj-inc-m)

Figure \@ref(fig:rex-proj-scenarios)
-->

The "No CPUE C^eq^ 50%" OM robustness scenario represents markedly different biomass and fishing mortality historical trajectories to any of the OM reference-set scenarios.
This OM scenario estimates the stock to be smaller (smaller $R_0$ values in Figure \@ref(fig:rex-sra-conditioned-parameters)) with high $F_y$ (apical $F$ by year) values around 2005 (Figure \@ref(fig:rex-F-om)).
In this OM scenario, the Itarget MPs are able to achieve LT LRP $>$ 0.60 (3 times out of 5), while the constant catch and surplus production model achieved LT LRP $<$ 0.35 (7 times out of 20) (Figures \@ref(fig:rex-tigure-panel-rob) and \@ref(fig:rex-dots-satisficed-mps-robust)).
Other performance metrics show less contrast among the MPs, although LT USR also remains higher for the Itarget vs. constant-catch or surplus-production MPs (Figure \@ref(fig:rex-tigure-panel-rob) and \@ref(fig:rex-dots-satisficed-mps-robust)).

This OM robustness scenario demonstrates stronger trade-offs among performance metrics than the OM reference-set scenarios (Figures \@ref(fig:rex-tradeoff-robust) and \@ref(fig:rex-spider-satisficed-mps-robust)).
In particular, there is an obvious trade-off between STC and LT LRP (Figures \@ref(fig:rex-tradeoff-robust)).
The constant catch MPs achieved the highest STC values but at the expense of lower LT LRP values.
The Itarget MPs struck more of a balance between LT LRP and STC (Figures \@ref(fig:rex-tradeoff-robust)).
The projection figures show the values underlying the performance metrics (Figure \@ref(fig:rex-proj-no-cpue-light)).
Within this scenario, over time, the .SP8040_0.6, CC1.1, and CC1.2 MPs all had a tendency to overfish the stock (Figure \@ref(fig:rex-proj-no-cpue-light)).

For the "M increasing" OM scenario, the satisficed MPs were fairly robust to linear increases in natural mortality in the projection period, with the exception that all satisficed MPs had a considerably lower probability of achieving the long-term catch (LTC) metric (Figures \@ref(fig:rex-tigure-panel-rob)--\@ref(fig:rex-spider-satisficed-mps-robust)).
Notably, the Itarget satisficed MPs maintained LT LRP $>$ 0.9 despite increasing *M*, whereas the fixed-catch and surplus-production MPs all resulted in LT LRP $<$ 0.9.
The Itarget MPs were able to ramp down catch as *M* increased (Figure \@ref(fig:rex-proj-inc-m)) to maintain most replicates above the LRP.

By plotting the projections from all OM scenarios (Figures \@ref(fig:rex-proj-ceq200)--\@ref(fig:rex-proj-no-cpue) and \@ref(fig:rex-proj-no-cpue-light)--\@ref(fig:rex-proj-inc-m)) on the same panels, we can examine the sensitivity of the projections to the various OM scenario conditions (Figure \@ref(fig:rex-proj-scenarios)).
The historical trajectories were most sensitive to the assumptions of the "No CPUE C^eq^ 50%" OM scenario compared to the other OM scenarios.
The projected trajectories were relatively similar across all OM reference-set scenarios, while differing for the "No CPUE C^eq^ 50%" and "M increasing" OM robustness scenarios.
Note that sensitivity of the projections does not necessarily correspond to sensitivity of the rank order of MPs (Figure \@ref(fig:rex-tigure-panel-rob)), which is ultimately the important characteristic for decision making.

(ref:fig-rex-tigure-panel-rob) Performance of satisficed MPs for the robustness set OMs.

```{r rex-tigure-panel-rob, fig.cap="(ref:fig-rex-tigure-panel-rob)", out.width="5.5in"}
knitr::include_graphics(here("report/figure/rex-tigure-robset.png"))
```

```{r rex-dots-satisficed-mps-robust, fig.cap="Performance of satisficed MPs for the robustness set OMs.", out.width="0.9\\textwidth"}
knitr::include_graphics(here("report/figure/rex-dot-robset.png"))
```

```{r rex-tradeoff-robust, fig.cap="Trade-off plot between LT LRP and STC performance metric values for satisficed MPs for the robustness set OMs.", out.width="6in"}
knitr::include_graphics(here("report/figure/rex-tradeoff-robset.png"))
```

```{r rex-spider-satisficed-mps-robust, fig.cap="Radar-plot representation of the trade-off in performance metric values for satisficed MPs for the robustness set OMs.", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-radar-robset.png"))
```

(ref:fig-rex-proj-no-cpue-light) Same as Figure \@ref(fig:rex-proj-ceq200) but for the robustness OM "No CPUE C^eq^ 50%".

```{r rex-proj-no-cpue-light, fig.cap="(ref:fig-rex-proj-no-cpue-light)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-no-cpue-light.png"))
```

(ref:fig-rex-proj-inc-m) Same as Figure \@ref(fig:rex-proj-ceq200) but for the robustness OM "Increasing M".

```{r rex-proj-inc-m, fig.cap="(ref:fig-rex-proj-inc-m)", out.width="6.5in"}
knitr::include_graphics(here("report/figure/rex-projections-inc-m.png"))
```

(ref:fig-rex-proj-scenarios) B/B~MSY~, F/F~MSY~, and catch from the historical and projected time periods.
Colours represent the reference- and OM robustness-set scenarios.
Lines represent medians and shaded regions represent 50% quantiles.
Satisficed and reference MPs are shown from top to bottom.
Vertical dashed lines represent 2019.

```{r rex-proj-scenarios, fig.cap="(ref:fig-rex-proj-scenarios)", out.width="\\textwidth"}
knitr::include_graphics(here("report/figure/rex-projections-scenarios.png"))
```
